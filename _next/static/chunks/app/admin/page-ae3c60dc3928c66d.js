(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[582],{4523:function(e,t,s){Promise.resolve().then(s.bind(s,2317))},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},2317:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var r=s(7437),a=s(2265),l=s(9376),o=()=>{let e=(0,l.useRouter)();return(0,r.jsx)("nav",{className:"backdrop-blur-lg bg-white/10 border-b border-white/20",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("span",{className:"text-xl font-bold text-white tracking-tight",children:"Salary Management"})}),(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsx)("button",{onClick:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("isAdmin"),e.push("/login")},className:"bg-red-500/20 hover:bg-red-500/30 text-white px-4 py-2 rounded-lg transition-colors duration-200 border border-red-500/50",children:"Logout"})})]})})})},i=()=>{let[e,t]=(0,a.useState)([]),[s,i]=(0,a.useState)(!0),[n,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(null),[h,x]=(0,a.useState)(""),[m,p]=(0,a.useState)(""),[b,g]=(0,a.useState)(""),[f,y]=(0,a.useState)(""),[w,j]=(0,a.useState)(""),N=(0,l.useRouter)();(0,a.useEffect)(()=>{let e=localStorage.getItem("authToken"),t=localStorage.getItem("isAdmin");e&&"1"===t||N.push("/login"),v()},[]);let v=async()=>{i(!0),c("");let e=localStorage.getItem("authToken");try{let s=await fetch("http://localhost:8000/api/salaries",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(401===s.status){N.push("/login");return}if(403===s.status){N.push("/admin-register");return}let r=await s.json();s.ok?t(r.salaries):c(r.message||"Failed to fetch salaries.")}catch(e){console.error("Fetch error:",e),c("Failed to connect to the backend API.")}finally{i(!1)}},S=(e,t,s,r)=>{u(e),x(t.toFixed(2)),p(s.toFixed(2)),g(r.toFixed(2)),y(""),j("")},k=async t=>{y(""),j("");let s=localStorage.getItem("authToken");if(!s){N.push("/login");return}try{let r=e.find(e=>e.email===t);if(!r){j("User not found for update.");return}let a=[];if(parseFloat(h)!==r.commission&&a.push(fetch("http://localhost:8000/api/commission",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({email:t,commission:parseFloat(h)})})),(parseFloat(m)!==r.salary_local_currency||parseFloat(b)!==r.salary_euros)&&a.push(fetch("http://localhost:8000/api/user-salary",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({email:t,salary_local_currency:parseFloat(m),salary_euros:parseFloat(b)})})),0===a.length){y("No changes to save."),u(null);return}let l=await Promise.all(a);if(l.every(e=>e.ok))y("User details updated successfully."),u(null),x(""),p(""),g(""),v();else{let e=await Promise.all(l.map(e=>e.json().catch(()=>({message:"Unknown error"}))));j("Failed to update some user details: "+e.map(e=>e.message).join(", ")),console.error("Error responses:",e)}}catch(e){console.error("Update user details fetch error:",e),c("Failed to connect to the backend API for user details update.")}},F=async e=>{if(!window.confirm("Are you sure you want to delete this user?"))return;i(!0),c("");let t=localStorage.getItem("authToken");try{let s=await fetch("http://localhost:8000/api/user/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),r=await s.json();s.ok?(y("User deleted successfully"),v()):j(r.message||"Failed to delete user")}catch(e){console.error("Delete error:",e),j("Failed to connect to the server")}finally{i(!1)}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-violet-900",children:[(0,r.jsx)(o,{}),(0,r.jsx)("div",{className:"p-4 md:p-8",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,r.jsxs)("div",{className:"backdrop-blur-lg bg-white/10 rounded-2xl shadow-2xl p-6 md:p-8 border border-white/20",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold mb-8 text-center text-white tracking-tight",children:"Admin Control Panel"}),s&&(0,r.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-white"})}),n&&(0,r.jsx)("div",{className:"bg-red-500/20 border border-red-500/50 rounded-lg p-4 mb-6 text-red-200",children:n}),f&&(0,r.jsx)("div",{className:"bg-green-500/20 border border-green-500/50 rounded-lg p-4 mb-6 text-green-200",children:f}),w&&(0,r.jsx)("div",{className:"bg-red-500/20 border border-red-500/50 rounded-lg p-4 mb-6 text-red-200",children:w}),!s&&!n&&(0===e.length?(0,r.jsx)("div",{className:"text-center text-gray-300 py-8",children:"No salary records found."}):(0,r.jsx)("div",{className:"overflow-x-auto rounded-xl",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-white/20",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-white/5",children:[(0,r.jsx)("th",{className:"py-4 px-6 text-left text-sm font-semibold text-white/80",children:"Name"}),(0,r.jsx)("th",{className:"py-4 px-6 text-left text-sm font-semibold text-white/80",children:"Email"}),(0,r.jsx)("th",{className:"py-4 px-6 text-left text-sm font-semibold text-white/80",children:"Local Salary"}),(0,r.jsx)("th",{className:"py-4 px-6 text-left text-sm font-semibold text-white/80",children:"Euro Salary"}),(0,r.jsx)("th",{className:"py-4 px-6 text-left text-sm font-semibold text-white/80",children:"Commission"}),(0,r.jsx)("th",{className:"py-4 px-6 text-left text-sm font-semibold text-white/80",children:"Displayed Salary"}),(0,r.jsx)("th",{className:"py-4 px-6 text-left text-sm font-semibold text-white/80",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-white/10",children:e.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-white/5 transition-colors duration-200",children:[(0,r.jsx)("td",{className:"py-4 px-6 text-sm text-white/90",children:e.name}),(0,r.jsx)("td",{className:"py-4 px-6 text-sm text-white/90",children:e.email}),(0,r.jsx)("td",{className:"py-4 px-6 text-sm text-white/90",children:d===e.email?(0,r.jsx)("input",{type:"number",value:m,onChange:e=>p(e.target.value),className:"w-full bg-white/10 border border-white/20 rounded px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-purple-500"}):(e.salary_local_currency||0).toFixed(2)}),(0,r.jsx)("td",{className:"py-4 px-6 text-sm text-white/90",children:d===e.email?(0,r.jsx)("input",{type:"number",value:b,onChange:e=>g(e.target.value),className:"w-full bg-white/10 border border-white/20 rounded px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-purple-500"}):(e.salary_euros||0).toFixed(2)}),(0,r.jsx)("td",{className:"py-4 px-6 text-sm text-white/90",children:d===e.email?(0,r.jsx)("input",{type:"number",value:h,onChange:e=>x(e.target.value),className:"w-full bg-white/10 border border-white/20 rounded px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-purple-500"}):(e.commission||0).toFixed(2)}),(0,r.jsx)("td",{className:"py-4 px-6 text-sm text-white/90",children:(e.displayed_salary||0).toFixed(2)}),(0,r.jsx)("td",{className:"py-4 px-6 text-sm",children:d===e.email?(0,r.jsx)("button",{onClick:()=>k(e.email),className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors duration-200",children:"Save"}):(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>S(e.email,e.commission,e.salary_local_currency,e.salary_euros),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors duration-200",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>F(e.email),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors duration-200",children:"Delete"})]})})]},e.id))})]})}))]})})})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=4523)}),_N_E=e.O()}]);